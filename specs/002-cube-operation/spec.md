# Feature Specification: 三次方運算功能

**Feature Branch**: `002-cube-operation`
**Created**: 2025-11-02
**Status**: Draft
**Input**: User description: "增加三次方的功能"

## User Scenarios & Testing *(mandatory)*

### User Story 1 - 基本三次方計算 (Priority: P1)

使用者在工程計算機中輸入一個數字後，點擊三次方按鈕（x³），計算機立即顯示該數字的三次方結果。這是三次方功能的核心使用情境。

**Why this priority**: 這是三次方功能的最基本需求，是 MVP 的核心。沒有這個功能，三次方運算無法執行。此功能獨立於其他運算，可單獨交付價值。

**Independent Test**: 可以透過輸入任意數字（如 3）、點擊 x³ 按鈕、驗證顯示結果為 27 來完整測試此功能，無需依賴其他運算功能。

**Acceptance Scenarios**:

1. **Given** 計算機顯示數字 5，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 125
2. **Given** 計算機顯示數字 2，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 8
3. **Given** 計算機顯示數字 10，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 1000
4. **Given** 計算機顯示數字 1，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 1
5. **Given** 計算機顯示數字 0，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 0

---

### User Story 2 - 負數三次方計算 (Priority: P2)

使用者能夠計算負數的三次方，系統正確處理負數運算並顯示正確結果（負數的三次方仍為負數）。

**Why this priority**: 負數三次方是常見的數學運算需求，但不如正數運算頻繁。可在基本功能完成後獨立添加。

**Independent Test**: 可以透過輸入負數（如 -3）、點擊 x³ 按鈕、驗證顯示結果為 -27 來獨立測試此功能。

**Acceptance Scenarios**:

1. **Given** 計算機顯示數字 -2，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 -8
2. **Given** 計算機顯示數字 -5，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 -125
3. **Given** 計算機顯示數字 -1，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 -1

---

### User Story 3 - 小數三次方計算 (Priority: P3)

使用者能夠計算小數的三次方，系統按照精確度要求（小數點後 6 位）顯示結果。

**Why this priority**: 小數運算是進階需求，使用頻率較低，但對工程計算很重要。可在基本整數運算完成後添加。

**Independent Test**: 可以透過輸入小數（如 1.5）、點擊 x³ 按鈕、驗證顯示結果為 3.375 來獨立測試此功能。

**Acceptance Scenarios**:

1. **Given** 計算機顯示數字 1.5，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 3.375
2. **Given** 計算機顯示數字 0.5，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 0.125
3. **Given** 計算機顯示數字 2.5，**When** 使用者點擊 x³ 按鈕，**Then** 計算機顯示 15.625

---

### Edge Cases

- **極大數值**: 當輸入的數字立方後超出 JavaScript 安全整數範圍（Number.MAX_SAFE_INTEGER）時如何處理？
- **極小數值**: 當輸入接近零的小數（如 0.0001）時，三次方結果是否正確顯示？
- **精確度**: 小數結果是否正確格式化為小數點後 6 位，並移除尾隨的零？
- **連續運算**: 使用者對三次方結果再次執行三次方運算（如 2³ = 8，8³ = 512）是否正常工作？
- **運算後清除**: 執行三次方運算後點擊 C 按鈕，是否正確重置計算機狀態？

## Requirements *(mandatory)*

### Functional Requirements

- **FR-001**: 系統必須提供三次方（x³）按鈕供使用者點擊
- **FR-002**: 系統必須能夠計算任意正數的三次方
- **FR-003**: 系統必須能夠計算任意負數的三次方，並正確顯示負數結果
- **FR-004**: 系統必須能夠計算小數的三次方
- **FR-005**: 系統必須將三次方計算結果格式化為小數點後 6 位
- **FR-006**: 系統必須移除結果中尾隨的零（與現有 formatResult 函數一致）
- **FR-007**: 系統必須驗證輸入為有效數字後才執行三次方運算
- **FR-008**: 三次方按鈕必須作為單運算元運算子（unary operator）運作，立即對當前顯示值進行運算
- **FR-009**: 三次方運算必須與現有的平方（x²）和開根號（√）功能一致，使用相同的事件處理模式

### Key Entities

- **三次方運算（Cube Operation）**: 將輸入數字自乘三次的數學運算，輸入為任意實數，輸出為該數的三次方值，保留小數點後 6 位精確度

## Success Criteria *(mandatory)*

### Measurable Outcomes

- **SC-001**: 使用者能在 1 秒內完成三次方運算（從點擊按鈕到顯示結果）
- **SC-002**: 三次方運算結果的精確度達到小數點後 6 位
- **SC-003**: 100% 的有效數字輸入（正數、負數、小數）都能正確計算三次方
- **SC-004**: 三次方功能與現有的平方和開根號功能具有一致的使用者體驗
- **SC-005**: 所有三次方運算測試（單元測試與整合測試）通過率達 100%

## Assumptions *(optional)*

- 三次方按鈕的 UI 設計與現有的 x² 按鈕風格一致
- 三次方運算使用 JavaScript 內建的 `Math.pow(x, 3)` 或 `x ** 3` 運算子
- 不需要處理複數或虛數的三次方運算
- 使用者介面文字使用正體中文
- 錯誤訊息（如輸入無效）使用正體中文
- 三次方功能不影響現有的四則運算、平方、開根號、三角函數功能

## Scope *(optional)*

### In Scope

- 新增三次方按鈕（x³）到計算機介面
- 實作三次方計算函數（cube function）
- 為三次方功能撰寫單元測試
- 為三次方功能撰寫整合測試
- 確保三次方功能與現有功能的相容性

### Out of Scope

- 修改現有的四則運算、平方、開根號、三角函數功能
- 新增其他次方運算（如四次方、五次方）
- 新增通用次方運算（xⁿ）功能
- 修改計算機的整體 UI 設計風格
- 新增科學記號顯示功能
